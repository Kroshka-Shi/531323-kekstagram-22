{"version":3,"sources":["webpack://kekstagram/./source/js/util.js","webpack://kekstagram/./source/js/photo-data.js","webpack://kekstagram/./source/js/constants.js","webpack://kekstagram/./source/js/comment-render.js","webpack://kekstagram/./source/js/big-picture.js","webpack://kekstagram/./source/js/preview-picture.js","webpack://kekstagram/./source/js/effects.js","webpack://kekstagram/./source/js/validate.js","webpack://kekstagram/./source/js/upload-picture.js","webpack://kekstagram/./source/js/download-status.js","webpack://kekstagram/./source/js/filters.js","webpack://kekstagram/./source/js/api.js","webpack://kekstagram/./source/js/main.js"],"names":["isEscEvent","evt","key","getIntValue","element","valueString","value","parseInt","photosData","getPhotosData","HASHTAG_REGEX","EFFECT_CLASS_START","ERROR_BORDER_STYLE","FILE_TYPES","EffectSliderSettings","range","min","max","step","start","ImageEffectStyles","bigPictureListElement","document","querySelector","bigPictureImageElement","bigPictureLikesElement","bigPictureDescriptionElement","bigPictureCommentCountElement","bigPictureCommentsBlockElement","bigPictureCommentCountBlockElement","bigPictureCommentsLoaderElement","templateCommentElement","content","commentsData","count","loadCommentData","end","commentsDataSlice","slice","currentCountComment","length","maxCountComment","textContent","renderComments","removeEventListener","classList","toggle","fragment","createDocumentFragment","forEach","avatar","name","message","cloneNode","src","alt","innerText","appendChild","bigPictureCloseElement","getDataModal","pictureDataID","photoId","target","undefined","dataset","parentNode","getPhotoId","find","id","url","likes","description","comments","innerHTML","addEventListener","renderPictureModalData","onOpenPictureModal","remove","body","add","onClosePictureModal","onPictureModalEscKeydown","preventDefault","pictureContainerElement","pictureTemplateElement","pictureWrapElement","checkClass","className","func","contains","renderPictures","photoData","renderPicture","onPictureEnterPress","isEnterEvent","imagePreviewElement","scaleControlValueElement","effectLevelBarElement","effectLevelValueElement","imageEffect","imageScaleStyle","imageEffectStyle","updateStyles","style","setPreviewScale","percent","scaleValue","scaleUp","number","scaleDown","clearEffect","removeEffectClasses","effectsList","querySelectorAll","button","push","getEffectList","effect","effectClassName","onEffectsChange","matches","effectClass","updateEffectSlider","noUiSlider","updateOptions","toUpperCase","uploadFormElement","hashtagInputElement","commentInputElement","checkValidityComment","string","maxLength","checkLengthComment","setCustomValidity","reportValidity","checkFormTag","word","test","checkValidityHashtag","hashtagArray","split","filter","elem","hashtagErrorCount","hashtagErrorFormat","every","hashtagErrorUniq","array","hashtagLower","map","toLowerCase","uniqueArr","Set","size","checkUniqueTag","fileInputElement","clientPictureElement","imgUploadOverlayElement","modalCloseButtonElement","scaleControlSmallerButtonElement","scaleControlBiggerButtonElement","onUploadModalEscPress","activeElement","onCloseUploadModal","destroy","successMessageTemplateElement","errorMessageTemplateElement","alertTemplateElement","onSuccessMessageEscPress","closeSuccessMessage","onSuccessMessageOverlayClick","successMessage","onErrorMessageEscPress","closeErrorMessage","onErrorMessageOverlayClick","errorMessage","buttonDefaultFilterElement","buttonRandomFilterElement","buttonDiscussedFilterElement","sortArray","data","sortFunction","sort","getRandomFilter","_","random","commentsFilter","a","b","clearFilters","filterButton","picture","applyDefaultFilter","applyRandomFilter","filterData","applyDiscussedFilter","sortedData","onSuccess","onError","throttle","alertMessage","setTimeout","showAlert","fetch","then","response","ok","json","Error","status","statusText","catch","err","file","files","fileName","some","it","endsWith","reader","FileReader","result","readAsDataURL","uploadClientPicture","create","connect","format","to","Number","isInteger","toFixed","from","parseFloat","on","values","handle","effectValueName","setImageEffectStyle","formData","method","sendData","FormData","setPhotoFormSubmit"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const checkLengthComment = (string = '', maxLength = 0) => {\n  return string.length <= maxLength;\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === ('Escape' || 'Esc');\n};\n\nconst isEnterEvent = (evt) => {\n  return evt.key === 'Enter';\n};\nconst getIntValue = (element) => {\n  const valueString = element.value;\n  return parseInt(valueString);\n};\n\nexport {\n  checkLengthComment,\n  isEscEvent,\n  isEnterEvent,\n  getIntValue\n};\n","let photosData = {};\n\nconst getPhotosData = () => {\n  return photosData;\n};\n\nconst setPhotosData = (data) => {\n  photosData = data;\n};\nexport {\n  getPhotosData,\n  setPhotosData\n}\n","const MAX_LENGTH_COMMENT = 140;\nconst MAX_COUNT_HASHTAG = 5;\nconst HASHTAG_REGEX = /^#[^\\W_]{1,19}$/;\n\nconst CONTROL_MAX_VALUE = 100;\nconst CONTROL_MIN_VALUE = 25;\nconst CONTROL_STEP = 25;\nconst CONTROL_DEFAULT_VALUE = 100;\nconst EFFECT_CLASS_START = 'effects__preview--';\n\nconst FORMAT_ERROR_MESSAGE = `Хэштег должен начинаться с # и состоять из букв и чисел,\nи не может содержать пробелы, спецсимволы (#, @, $ и т. п.), \nсимволы пунктуации (тире, дефис, запятая и т. п.), эмодзи и т.д`;\nconst COUNT_ERROR_MESSAGE = `Максимальное колличество хэштегов ${MAX_COUNT_HASHTAG}`;\nconst UNIQUE_ERROR_MESSAGE = 'Хэштег должен быть уникальным.';\nconst LENGTH_ERROR_MESSAGE = 'Комментарий не может быть больше ' + MAX_LENGTH_COMMENT + ' символов';\n\nconst ALERT_SHOW_TIME = 5000;\nconst DOWNLOAD_ERROR_MESSAGE = `Ошибка загрузки данных.\nПожалуйста обратитесь к администратору сайта или попробуйте позже.`;\nconst ERROR_BORDER_STYLE = 'border--error';\n\nconst GET_DATA_URL = 'https://22.javascript.pages.academy/kekstagram/data';\nconst SEND_DATA_URL = 'https://22.javascript.pages.academy/kekstagram';\n\nconst RANDOM_PHOTO_COUNT = 10;\nconst TIME_BOUNCE_DELETE = 500;\n\nconst MAX_LOAD_COMMENT = 5;\n\nconst FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst EffectSliderSettings = {\n  'CHROME': {\n    range: {\n      min: 0,\n      max: 1,\n    },\n    step: 0.1,\n    start: 1,\n  },\n  'SEPIA': {\n    range: {\n      min: 0,\n      max: 1,\n    },\n    step: 0.1,\n    start: 1,\n  },\n  'MARVIN': {\n    range: {\n      min: 0,\n      max: 100,\n    },\n    step: 1,\n    start: 100,\n  },\n  'PHOBOS': {\n    range: {\n      min: 0,\n      max: 3,\n    },\n    step: 0.1,\n    start: 3,\n  },\n  'HEAT': {\n    range: {\n      min: 1,\n      max: 3,\n    },\n    step: 0.1,\n    start: 3,\n  },\n};\n\nconst ImageEffectStyles = {\n  'CHROME': 'grayscale',\n  'SEPIA': 'sepia',\n  'MARVIN': 'invert',\n  'PHOBOS': 'blur',\n  'HEAT': 'brightness',\n};\n\nexport {\n  CONTROL_MAX_VALUE,\n  CONTROL_MIN_VALUE,\n  CONTROL_STEP,\n  CONTROL_DEFAULT_VALUE,\n  EffectSliderSettings,\n  ImageEffectStyles,\n  EFFECT_CLASS_START,\n  MAX_LENGTH_COMMENT,\n  MAX_COUNT_HASHTAG,\n  HASHTAG_REGEX,\n  FORMAT_ERROR_MESSAGE,\n  COUNT_ERROR_MESSAGE,\n  UNIQUE_ERROR_MESSAGE,\n  LENGTH_ERROR_MESSAGE,\n  ALERT_SHOW_TIME,\n  DOWNLOAD_ERROR_MESSAGE,\n  GET_DATA_URL,\n  SEND_DATA_URL,\n  RANDOM_PHOTO_COUNT,\n  TIME_BOUNCE_DELETE,\n  MAX_LOAD_COMMENT,\n  FILE_TYPES,\n  ERROR_BORDER_STYLE\n}\n","import {\n  MAX_LOAD_COMMENT\n} from './constants.js';\n\nconst bigPictureListElement = document.querySelector('.big-picture');\nconst bigPictureImageElement = bigPictureListElement.querySelector('img');\nconst bigPictureLikesElement = bigPictureListElement.querySelector('.likes-count');\nconst bigPictureDescriptionElement = bigPictureListElement.querySelector('.social__caption');\nconst bigPictureCommentCountElement = bigPictureListElement.querySelector('.comments-count');\nconst bigPictureCommentsBlockElement = bigPictureListElement.querySelector('.social__comments');\nconst bigPictureCommentCountBlockElement = bigPictureListElement.querySelector('.social__comment-count');\nconst bigPictureCommentsLoaderElement = bigPictureListElement.querySelector('.comments-loader');\nconst templateCommentElement = document.querySelector('#social__comment').content.querySelector('.social__comment');\n\nlet commentsData = {};\nlet count = 1;\n\nconst loadCommentData = () => {\n\n  const start = count++ * MAX_LOAD_COMMENT;\n  const end = count * MAX_LOAD_COMMENT;\n\n  const commentsDataSlice = commentsData.slice(start, end);\n  const currentCountComment = commentsDataSlice.length + start;\n  const maxCountComment = bigPictureCommentCountElement.textContent;\n  bigPictureCommentCountBlockElement.textContent = `${currentCountComment} из ${maxCountComment} комментариев`;\n  renderComments(commentsDataSlice);\n\n  if (commentsData.length <= end) {\n    bigPictureCommentCountElement.textContent = commentsData.length;\n    bigPictureCommentsLoaderElement.removeEventListener('click', loadCommentData);\n    bigPictureCommentsLoaderElement.classList.toggle('hidden', true);\n  }\n};\n\nconst loadComments = () => {\n  bigPictureCommentCountElement.textContent = commentsData.length;\n  bigPictureCommentsBlockElement.innerHTML = '';\n  count = 0;\n  loadCommentData();\n\n  if (commentsData.length <= MAX_LOAD_COMMENT) {\n    bigPictureCommentsLoaderElement.classList.toggle('hidden', true);\n  } else {\n    bigPictureCommentsLoaderElement.addEventListener('click', loadCommentData);\n    bigPictureCommentsLoaderElement.classList.toggle('hidden', false);\n  }\n};\n\nconst renderComments = (commentsData) => {\n  const fragment = document.createDocumentFragment();\n  commentsData.forEach(({\n    avatar,\n    name,\n    message,\n  }) => {\n    const element = templateCommentElement.cloneNode(true);\n    element.querySelector('.social__picture').src = avatar;\n    element.querySelector('.social__picture').alt = name;\n    element.querySelector('.social__text').innerText = message;\n    fragment.appendChild(element);\n  });\n  bigPictureCommentsBlockElement.appendChild(fragment);\n};\n\nconst renderPictureModalData = ({\n  url,\n  likes,\n  description,\n  comments,\n}) => {\n  bigPictureImageElement.src = url;\n  bigPictureLikesElement.textContent = likes;\n  bigPictureDescriptionElement.textContent = description;\n  commentsData = comments;\n  loadComments();\n};\n\nexport {\n  renderPictureModalData,\n  bigPictureListElement\n}\n","import {\n  isEscEvent\n} from './util.js';\n\nimport {\n  getPhotosData\n} from './photo-data.js';\n\nimport {\n  renderPictureModalData,\n  bigPictureListElement\n} from './comment-render.js';\n\nconst bigPictureCloseElement = bigPictureListElement.querySelector('.big-picture__cancel');\n\nconst getPhotoId = (evt) => {\n  const target = evt.target;\n  if (target.dataset.photoId !== undefined) {\n    return target.dataset.photoId;\n  }\n  const parentTarget = target.parentNode;\n  return parentTarget.dataset.photoId;\n};\n\nconst getPhotoDataById = (photoId) => {\n  const photosData = getPhotosData();\n  return photosData.find((element) => {\n    return element.id === parseInt(photoId);\n  });\n};\n\nconst getDataModal = (evt) => {\n  const photoId = getPhotoId(evt);\n  const pictureDataID = getPhotoDataById(photoId);\n  if (!pictureDataID) {\n    return;\n  }\n  renderPictureModalData(pictureDataID);\n};\n\nconst onOpenPictureModal = (evt) => {\n  getDataModal(evt);\n  bigPictureListElement.classList.remove('hidden');\n  document.body.classList.add('modal-open');\n\n  bigPictureCloseElement.addEventListener('click', onClosePictureModal);\n  document.addEventListener('keydown', onPictureModalEscKeydown);\n\n};\n\nconst onClosePictureModal = () => {\n  bigPictureListElement.classList.add('hidden');\n  document.body.classList.remove('modal-open');\n\n  bigPictureCloseElement.removeEventListener('click', onClosePictureModal);\n  document.removeEventListener('keydown', onPictureModalEscKeydown);\n};\n\nconst onPictureModalEscKeydown = (evt) => {\n  if (!isEscEvent(evt)) {\n    return;\n  }\n  evt.preventDefault();\n  onClosePictureModal();\n};\n\nexport {\n  onOpenPictureModal\n};\n","import {\n  onOpenPictureModal\n} from './big-picture.js';\n\nimport {\n  isEnterEvent\n} from './util.js';\n\nconst pictureContainerElement = document.querySelector('.pictures');\nconst pictureTemplateElement = document.querySelector('#picture').content.querySelector('a.picture');\nconst pictureWrapElement = document.querySelector('.pictures');\n\nconst renderPicture = (photoData) => {\n  const element = pictureTemplateElement.cloneNode(true);\n  element.dataset.photoId = photoData.id;\n  element.querySelector('.picture__img').src = photoData.url;\n  element.querySelector('.picture__comments').innerText = photoData.comments.length;\n  element.querySelector('.picture__likes').innerText = photoData.likes;\n  return element;\n};\n\nconst checkClass = (evt, className, func) => {\n  if (evt.target && evt.target.classList.contains(className)) {\n    evt.preventDefault();\n    func(evt);\n  }\n};\n\nconst renderPictures = (photoData) => {\n  const fragment = document.createDocumentFragment();\n  photoData.forEach(element => fragment.appendChild(renderPicture(element)));\n  pictureContainerElement.appendChild(fragment);\n  pictureWrapElement.addEventListener('click', (evt) => {\n    checkClass(evt, 'picture__img', onOpenPictureModal);\n  });\n  pictureWrapElement.addEventListener('keydown', (evt) => {\n    checkClass(evt, 'picture', onPictureEnterPress)\n  });\n};\n\nconst onPictureEnterPress = (evt) => {\n  if (!isEnterEvent(evt)) {\n    return\n  }\n  evt.preventDefault();\n  onOpenPictureModal(evt);\n};\n\nexport {\n  renderPictures,\n  onOpenPictureModal,\n  onPictureEnterPress\n};\n","import {\n  getIntValue\n} from './util.js';\n\nimport {\n  CONTROL_MAX_VALUE,\n  CONTROL_MIN_VALUE,\n  CONTROL_STEP,\n  CONTROL_DEFAULT_VALUE,\n  EffectSliderSettings,\n  ImageEffectStyles,\n  EFFECT_CLASS_START\n} from './constants.js';\n\nconst imagePreviewElement = document.querySelector('.img-upload__preview img');\nconst scaleControlValueElement = document.querySelector('.scale__control--value');\n\nconst effectLevelBarElement = document.querySelector('.img-upload__effect-level');\nconst effectLevelValueElement = document.querySelector('.effect-level__value');\n\nlet imageEffect = 'none';\nlet imageScaleStyle = '';\nlet imageEffectStyle = '';\n\nconst updateStyles = (element, style) => {\n  element.style = style;\n};\n\nconst setPreviewScale = (element, percent) => {\n  const scaleValue = percent / 100;\n  scaleControlValueElement.value = percent + '%';\n  imageScaleStyle = `transform: scale(${scaleValue});`;\n  updateStyles(element, imageScaleStyle + imageEffectStyle);\n};\n\nconst setPreviewDefaultScale = () => {\n  setPreviewScale(imagePreviewElement, CONTROL_DEFAULT_VALUE);\n};\n\nconst scaleUp = () => {\n  let number = getIntValue(scaleControlValueElement);\n  if ((number + CONTROL_STEP) <= CONTROL_MAX_VALUE) {\n    number += CONTROL_STEP;\n    setPreviewScale(imagePreviewElement, number);\n  }\n};\n\nconst scaleDown = () => {\n  let number = getIntValue(scaleControlValueElement);\n  if ((number - CONTROL_STEP) >= CONTROL_MIN_VALUE) {\n    number -= CONTROL_STEP;\n    setPreviewScale(imagePreviewElement, number);\n  }\n};\n\nconst clearEffect = () => {\n  removeEffectClasses();\n  effectLevelBarElement.classList.add('hidden');\n  imageEffectStyle = '';\n  updateStyles(imagePreviewElement, imageScaleStyle + imageEffectStyle);\n};\n\nconst getEffectList = () => {\n  const effectsList = [];\n  const effectButtons = document.querySelectorAll('.effects__radio');\n  effectButtons.forEach(button => effectsList.push(button.value));\n  return effectsList;\n};\n\nconst removeEffectClasses = () => {\n  const effectsList = getEffectList();\n  effectsList.forEach((effect) => {\n    const effectClassName = EFFECT_CLASS_START + effect;\n    imagePreviewElement.classList.toggle(effectClassName, false)\n  });\n};\n\nconst onEffectsChange = (evt) => {\n  if (evt.target && evt.target.matches('input[type=\"radio\"]')) {\n    removeEffectClasses();\n    imageEffect = evt.target.value;\n    if (imageEffect === 'none') {\n      clearEffect();\n      return;\n    }\n    const effectClass = EFFECT_CLASS_START + imageEffect;\n    updateEffectSlider(imageEffect);\n    imagePreviewElement.classList.add(effectClass);\n    effectLevelBarElement.classList.toggle('hidden', false);\n  }\n};\n\nconst setImageEffectStyle = () => {\n  let effectValueName = '';\n  if (imageEffect === 'marvin') {\n    effectValueName = '%';\n  } else if (imageEffect === 'phobos') {\n    effectValueName = 'px';\n  }\n  imageEffectStyle = `filter: ${ImageEffectStyles[imageEffect.toUpperCase()]}(${effectLevelValueElement.value}${effectValueName})`;\n  updateStyles(imagePreviewElement, imageScaleStyle + imageEffectStyle);\n};\n\nconst createEffectSlider = () => {\n  noUiSlider.create(effectLevelBarElement, {\n    range: {\n      min: 0,\n      max: 1,\n    },\n    start: 1,\n    step: 0.1,\n    connect: 'lower',\n    format: {\n      to: (value) => {\n        if (Number.isInteger(value)) {\n          return value.toFixed(0);\n        }\n        return value.toFixed(1);\n      },\n      from: (value) => {\n        return parseFloat(value);\n      },\n    },\n  });\n\n  effectLevelBarElement.noUiSlider.on('update', (values, handle) => {\n    effectLevelValueElement.value = values[handle];\n    setImageEffectStyle();\n  });\n};\n\nconst updateEffectSlider = (imageEffect) => {\n  effectLevelBarElement.noUiSlider.updateOptions(EffectSliderSettings[imageEffect.toUpperCase()]);\n};\n\nconst closeEffectSlider = () => {\n  effectLevelBarElement.noUiSlider.destroy();\n};\n\nexport {\n  scaleDown,\n  scaleUp,\n  setPreviewDefaultScale,\n  onEffectsChange,\n  clearEffect,\n  createEffectSlider,\n  closeEffectSlider\n};\n","import {\n  checkLengthComment\n} from './util.js';\n\nimport {\n  MAX_LENGTH_COMMENT,\n  MAX_COUNT_HASHTAG,\n  HASHTAG_REGEX,\n  FORMAT_ERROR_MESSAGE,\n  COUNT_ERROR_MESSAGE,\n  UNIQUE_ERROR_MESSAGE,\n  LENGTH_ERROR_MESSAGE,\n  SEND_DATA_URL,\n  ERROR_BORDER_STYLE\n} from './constants.js';\n\nimport {\n  sendData\n} from './api.js';\n\nimport {\n  onCloseUploadModal\n} from './upload-picture.js';\n\nconst uploadFormElement = document.querySelector('.img-upload__form');\nconst hashtagInputElement = document.querySelector('.text__hashtags');\nconst commentInputElement = document.querySelector('.text__description');\n\nconst checkValidityComment = (evt) => {\n  if (!checkLengthComment(evt.target.value, MAX_LENGTH_COMMENT)) {\n    evt.target.setCustomValidity(LENGTH_ERROR_MESSAGE);\n    commentInputElement.classList.add('border--error');\n  } else {\n    evt.target.setCustomValidity('');\n    commentInputElement.classList.remove('border--error');\n  }\n  evt.target.reportValidity();\n}\n\nconst checkFormTag = (word) => {\n  return HASHTAG_REGEX.test(word);\n};\n\nconst checkUniqueTag = (array) => {\n  const hashtagLower = array.map(elem => {\n    return elem.toLowerCase();\n  });\n  const uniqueArr = new Set(hashtagLower);\n  return array.length === uniqueArr.size;\n};\n\nconst checkValidityHashtag = (evt) => {\n  const hashtagArrOrigin = evt.target.value.split(' ');\n  const hashtagArray = hashtagArrOrigin.filter(elem => elem !== '');\n\n  const hashtagErrorCount = hashtagArray.length > MAX_COUNT_HASHTAG;\n  const hashtagErrorFormat = !hashtagArray.every(checkFormTag);\n  const hashtagErrorUniq = !checkUniqueTag(hashtagArray);\n\n  switch (true) {\n    case hashtagErrorFormat:\n      evt.target.setCustomValidity(FORMAT_ERROR_MESSAGE);\n      hashtagInputElement.classList.add(ERROR_BORDER_STYLE);\n      break;\n    case hashtagErrorCount:\n      evt.target.setCustomValidity(COUNT_ERROR_MESSAGE);\n      hashtagInputElement.classList.add(ERROR_BORDER_STYLE);\n      break;\n    case hashtagErrorUniq:\n      evt.target.setCustomValidity(UNIQUE_ERROR_MESSAGE);\n      hashtagInputElement.classList.add(ERROR_BORDER_STYLE);\n      break;\n    default:\n      evt.target.setCustomValidity('');\n      hashtagInputElement.classList.remove(ERROR_BORDER_STYLE);\n  }\n  evt.target.reportValidity();\n};\n\nconst setPhotoFormSubmit = (onSuccess, onError) => {\n  uploadFormElement.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n    const formData = new FormData(evt.target);\n    sendData(SEND_DATA_URL, formData, onSuccess, onError);\n    onCloseUploadModal();\n  })\n};\n\nexport {\n  hashtagInputElement,\n  commentInputElement,\n  checkValidityComment,\n  checkValidityHashtag,\n  setPhotoFormSubmit\n}\n","import {\n  isEscEvent\n} from './util.js';\n\nimport {\n  setPreviewDefaultScale,\n  scaleDown,\n  scaleUp,\n  onEffectsChange,\n  clearEffect,\n  createEffectSlider,\n  closeEffectSlider\n} from './effects.js';\n\nimport {\n  hashtagInputElement,\n  commentInputElement,\n  checkValidityComment,\n  checkValidityHashtag\n} from './validate.js';\n\nimport {\n  FILE_TYPES\n} from './constants.js';\n\nconst fileInputElement = document.querySelector('#upload-file');\nconst clientPictureElement = document.querySelector('.img-upload__preview img');\n\nconst imgUploadOverlayElement = document.querySelector('.img-upload__overlay');\nconst modalCloseButtonElement = document.querySelector('#upload-cancel');\nconst uploadFormElement = document.querySelector('.img-upload__form');\nconst scaleControlSmallerButtonElement = document.querySelector('.scale__control--smaller');\nconst scaleControlBiggerButtonElement = document.querySelector('.scale__control--bigger');\n\nconst onUploadModalEscPress = (evt) => {\n  if (!isEscEvent(evt)) {\n    return;\n  }\n  evt.preventDefault();\n  if (commentInputElement !== document.activeElement && hashtagInputElement !== document.activeElement) {\n    onCloseUploadModal();\n  }\n};\n\nconst uploadClientPicture = () => {\n  const file = fileInputElement.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      clientPictureElement.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n    reader.removeEventListener('load', () => {\n      clientPictureElement.src = reader.result;\n    });\n  }\n};\n\nconst clearValidityForm = () => {\n  fileInputElement.value = '';\n  commentInputElement.value = '';\n  hashtagInputElement.value = '';\n  commentInputElement.classList.remove('border--error');\n  hashtagInputElement.classList.remove('border--error');\n};\n\nconst onCloseUploadModal = () => {\n  imgUploadOverlayElement.classList.add('hidden');\n  document.body.classList.remove('modal-open');\n\n  document.removeEventListener('keydown', onUploadModalEscPress);\n  modalCloseButtonElement.removeEventListener('click', onCloseUploadModal);\n\n  scaleControlSmallerButtonElement.removeEventListener('click', scaleDown);\n  scaleControlBiggerButtonElement.removeEventListener('click', scaleUp);\n  uploadFormElement.removeEventListener('change', onEffectsChange);\n\n  commentInputElement.removeEventListener('input', checkValidityComment);\n  hashtagInputElement.removeEventListener('input', checkValidityHashtag);\n\n  clearValidityForm();\n  closeEffectSlider();\n};\n\nconst onOpenUploadModal = () => {\n  uploadClientPicture();\n  imgUploadOverlayElement.classList.remove('hidden');\n  document.body.classList.add('modal-open');\n\n  document.addEventListener('keydown', onUploadModalEscPress);\n  modalCloseButtonElement.addEventListener('click', onCloseUploadModal);\n\n  scaleControlSmallerButtonElement.addEventListener('click', scaleDown);\n  scaleControlBiggerButtonElement.addEventListener('click', scaleUp);\n  uploadFormElement.addEventListener('change', onEffectsChange);\n\n  commentInputElement.addEventListener('input', checkValidityComment);\n  hashtagInputElement.addEventListener('input', checkValidityHashtag);\n\n  setPreviewDefaultScale();\n  createEffectSlider();\n  clearEffect();\n};\n\nexport {\n  fileInputElement,\n  onOpenUploadModal,\n  onCloseUploadModal\n};\n","import {\n  isEscEvent\n} from './util.js';\n\nimport {\n  DOWNLOAD_ERROR_MESSAGE,\n  ALERT_SHOW_TIME\n} from './constants.js';\n\nconst successMessageTemplateElement = document.querySelector('#success').content.querySelector('.success');\nconst errorMessageTemplateElement = document.querySelector('#error').content.querySelector('.error');\nconst alertTemplateElement = document.querySelector('#alert-message').content.querySelector('.alert-message');\n\nconst onSuccessMessageEscPress = (evt) => {\n  if (!isEscEvent(evt)) {\n    return;\n  }\n  evt.preventDefault();\n  closeSuccessMessage();\n};\n\nconst onSuccessMessageOverlayClick = (evt) => {\n  if (evt.target.classList.contains('success')) {\n    closeSuccessMessage();\n  }\n};\n\nconst closeSuccessMessage = () => {\n  const successMessage = document.querySelector('.success');\n  const successButton = successMessage.querySelector('.success__button');\n  successButton.removeEventListener('click', closeSuccessMessage);\n  successMessage.removeEventListener('click', onSuccessMessageOverlayClick);\n  document.removeEventListener('keydown', onSuccessMessageEscPress);\n  successMessage.remove();\n};\n\nconst openSuccessMessage = () => {\n  const successMessage = successMessageTemplateElement.cloneNode(true);\n  document.body.appendChild(successMessage);\n  const successButton = document.querySelector('.success__button');\n\n  successButton.addEventListener('click', closeSuccessMessage);\n  successMessage.addEventListener('click', onSuccessMessageOverlayClick);\n  document.addEventListener('keydown', onSuccessMessageEscPress);\n};\n\nconst onErrorMessageEscPress = (evt) => {\n  if (!isEscEvent(evt)) {\n    return;\n  }\n  evt.preventDefault();\n  closeErrorMessage();\n};\n\nconst onErrorMessageOverlayClick = (evt) => {\n  if (evt.target.classList.contains('error')) {\n    closeErrorMessage();\n  }\n};\n\nconst closeErrorMessage = () => {\n  const errorMessage = document.querySelector('.error');\n  const errorButton = errorMessage.querySelector('.error__button');\n  errorButton.removeEventListener('click', closeErrorMessage);\n  errorMessage.removeEventListener('click', onErrorMessageOverlayClick);\n  document.removeEventListener('keydown', onErrorMessageEscPress);\n  errorMessage.remove();\n};\n\nconst openErrorMessage = () => {\n  const errorMessage = errorMessageTemplateElement.cloneNode(true);\n  document.body.appendChild(errorMessage);\n  errorMessage.addEventListener('click', onErrorMessageOverlayClick);\n\n  const errorButton = document.querySelector('.error__button');\n  errorButton.addEventListener('click', closeErrorMessage);\n\n  document.addEventListener('keydown', onErrorMessageEscPress);\n};\n\nconst showAlert = (alertMessage) => {\n  const element = alertTemplateElement.cloneNode(true);\n  element.innerText = alertMessage;\n  document.body.appendChild(element);\n\n  setTimeout(() => {\n    element.remove();\n  }, ALERT_SHOW_TIME);\n};\n\nconst openDownloadErrorAlert = () => {\n  showAlert(DOWNLOAD_ERROR_MESSAGE);\n};\n\nexport {\n  openSuccessMessage,\n  openErrorMessage,\n  openDownloadErrorAlert\n};\n","import {\n  getPhotosData\n} from './photo-data.js';\n\nimport {\n  renderPictures\n} from './preview-picture.js';\n\nimport {\n  RANDOM_PHOTO_COUNT,\n  TIME_BOUNCE_DELETE\n} from './constants.js';\n\nconst buttonDefaultFilterElement = document.querySelector('#filter-default');\nconst buttonRandomFilterElement = document.querySelector('#filter-random');\nconst buttonDiscussedFilterElement = document.querySelector('#filter-discussed');\n\nconst clearFilterButtons = () => {\n  const filterButtons = document.querySelectorAll('.img-filters__button');\n  filterButtons.forEach((button) => {\n    button.classList.toggle('img-filters__button--active', false);\n  });\n};\n\nconst clearPictures = () => {\n  const pictures = document.querySelectorAll('.picture');\n  pictures.forEach((picture) => {\n    picture.remove();\n  });\n};\n\nconst sortArray = (data, sortFunction) => {\n  return data.slice().sort(sortFunction);\n};\n\nconst getRandomFilter = () => {\n  return _.random(0, 2) - 1;\n};\n\nconst commentsFilter = (a, b) => {\n  return b.comments.length - a.comments.length\n};\n\nconst clearFilters = (filterButton) => {\n  clearFilterButtons();\n  filterButton.classList.add('img-filters__button--active');\n  clearPictures();\n};\n\nconst applyDefaultFilter = () => {\n  const data = getPhotosData();\n  clearFilters(buttonDefaultFilterElement);\n  renderPictures(data);\n};\n\nconst applyRandomFilter = () => {\n  const data = getPhotosData();\n  const sortedData = sortArray(data, getRandomFilter);\n  const filterData = sortedData.slice(0, RANDOM_PHOTO_COUNT);\n  clearFilters(buttonRandomFilterElement);\n  renderPictures(filterData);\n};\n\nconst applyDiscussedFilter = () => {\n  const data = getPhotosData();\n  const sortedData = sortArray(data, commentsFilter);\n  clearFilters(buttonDiscussedFilterElement);\n  renderPictures(sortedData);\n};\n\nconst showFilterButtons = () => {\n  const filters = document.querySelector('.img-filters');\n  filters.classList.remove('img-filters--inactive');\n  buttonDefaultFilterElement.addEventListener('click', _.throttle(applyDefaultFilter, TIME_BOUNCE_DELETE));\n  buttonRandomFilterElement.addEventListener('click', _.throttle(applyRandomFilter, TIME_BOUNCE_DELETE));\n  buttonDiscussedFilterElement.addEventListener('click', _.throttle(applyDiscussedFilter, TIME_BOUNCE_DELETE));\n};\n\nexport {\n  showFilterButtons\n}\n","const getData = (url, onSuccess, onError) => {\n  fetch(url)\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      throw new Error(`${response.status} ${response.statusText}`);\n    })\n    .then((data) => {\n      onSuccess(data);\n    })\n    .catch((err) => {\n      onError(err);\n    })\n};\n\nconst sendData = (url, formData, onSuccess, onError) => {\n  fetch(url, {\n    method: 'POST',\n    body: formData,\n  })\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      throw new Error(`${response.status} ${response.statusText}`);\n    })\n    .then(() => onSuccess())\n    .catch((err) => {\n      onError(err);\n    })\n};\n\nexport {\n  getData,\n  sendData\n};\n","import {\n  renderPictures\n} from './preview-picture.js';\n\nimport {\n  fileInputElement,\n  onOpenUploadModal\n} from './upload-picture.js';\n\nimport {\n  getData\n} from './api.js';\n\nimport {\n  openSuccessMessage,\n  openErrorMessage,\n  openDownloadErrorAlert\n} from './download-status.js';\n\nimport {\n  GET_DATA_URL\n} from './constants.js';\n\nimport {\n  setPhotosData\n} from './photo-data.js';\nimport {\n  setPhotoFormSubmit\n} from './validate.js';\n\nimport {\n  showFilterButtons\n} from './filters.js';\n\nconst onPhotoDataLoaded = (photoData) => {\n  setPhotosData(photoData);\n  renderPictures(photoData);\n  showFilterButtons();\n};\n\ngetData(GET_DATA_URL, onPhotoDataLoaded, openDownloadErrorAlert);\nfileInputElement.addEventListener('change', onOpenUploadModal);\nsetPhotoFormSubmit(openSuccessMessage, openErrorMessage);\n"],"sourceRoot":""}